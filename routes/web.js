const _0x1e6a65 = _0x3389; (function (_0x3b0179, _0x1a0f55) { const _0x12da28 = _0x3389, _0x48a542 = _0x3b0179(); while (!![]) { try { const _0xf13d1 = parseInt(_0x12da28(0x179)) / 0x1 + -parseInt(_0x12da28(0x19e)) / 0x2 * (-parseInt(_0x12da28(0x1c5)) / 0x3) + parseInt(_0x12da28(0x19a)) / 0x4 + parseInt(_0x12da28(0x180)) / 0x5 + -parseInt(_0x12da28(0x1b2)) / 0x6 * (-parseInt(_0x12da28(0x198)) / 0x7) + parseInt(_0x12da28(0x1c7)) / 0x8 + parseInt(_0x12da28(0x17a)) / 0x9 * (-parseInt(_0x12da28(0x1d5)) / 0xa); if (_0xf13d1 === _0x1a0f55) break; else _0x48a542['push'](_0x48a542['shift']()); } catch (_0x428b33) { _0x48a542['push'](_0x48a542['shift']()); } } }(_0xcab4, 0x74f8f)); function _0xcab4() { const _0x1f38b3 = ['smtp_host', '\x27,\x20\x0a\x20\x20\x20\x20rz_id\x20=\x20\x27', 'createPool', 'file', 'post', '/update_set', 'admin', '../middlewares/admin', 'success', '\x27,\x20smtp_password\x20=\x20\x27', 'admin_password', '\x27,\x27https://youtu.be/ZFfarXDW-FM\x27,\x20\x27695411674837821333000481667807168956logo_512x512.png\x27)\x20', 'jwt', '/../middlewares/admin.js', 'bcrypt', '\x27,\x20rz_key\x20=\x20\x27', 'files', 'random', 'body', '318997QcpkWP', 'mysql-import', '2384864jOgUei', '\x27,\x20smtp_port\x20=\x20\x27', 'offline_msg', '/../client/public/images/', '1677926SDQydb', 'query', '\x27,\x27', 'log', 'http://verify-whatsham.oneoftheprojects.com/api/verify/whatsham?purchase_code=', 'smtp_email', 'msg', 'offline_is_active', 'Db\x20query\x20error\x2001', '\x27,\x20paypal_client_id\x20=\x20\x27', 'Settings\x20has\x20been\x20updated', 'error', 'replace', '../middlewares/user', 'smtp_password', 'DBPORT', 'now', 'DBUSER', 'SELECT\x20*\x20FROM\x20web', 'Connection\x20issue!\x20Please\x20contact\x20support\x20of\x20Whatsham\x20at\x20hello@hamidsaifi.com.', '66zqdffr', 'catch', 'DBHOST', 'length', 'UPDATE\x20web\x20SET\x20rz_is_is_active\x20=\x20\x27', '\x27,\x0a\x20\x20\x20\x20paypal_client_secret\x20=\x20\x27', 'UPDATE\x20web\x20SET\x20app_name\x20=\x20\x27', 'Send\x20all\x20required\x20fields', '\x27,\x20offline_is_active\x20=\x20\x27', 'then', '/all_db', 'writeFile', 'DBPASSWORD', 'generate', 'readFile', 'rz_key', '&domain=', '\x27,\x20\x0a\x20\x20\x20\x20paypal_is_active\x20=\x20\x27', 'openai_key', '3hjzwEC', '\x27,\x20currency_symbol\x20=\x20\x27', '1000088ItqDJy', 'exchange_rate', '\x27,\x20home_video\x20=\x20\x27', 'json', 'home_video', '\x27,\x20exchange_rate\x20=\x20\x27', 'utf8', 'app_name', 'paypal_client_secret', 'DB\x20query\x20error', 'smtp_port', '\x27,\x20openai_key\x20=\x20\x27', 'import', 'randomstring', '33390HcbiDX', 'admin_email', 'No\x20sql\x20file\x20found\x20to\x20install', 'get', 'currency_symbol', 'INSERT\x20INTO\x20web\x20(app_name,\x20currency_symbol,\x20exchange_rate,\x20home_video,\x20logo)\x20VALUES\x20(\x27', 'SHOW\x20TABLES\x20FROM\x20u687661449_aaa', 'getConnection', 'purchase_code', 'message', '/update_smtp', '458187cmLlqd', '7191bMqLCD', 'paypal_is_active', '/get', 'env', 'status', 'SHOW\x20TABLES\x20FROM\x20', '3136610qHooNd', 'Db\x20query\x20error', 'token', 'rz_is_is_active', 'rz_id']; _0xcab4 = function () { return _0x1f38b3; }; return _0xcab4(); } const router = require('express')['Router'](), con = require('../config/config'), bcrypt = require(_0x1e6a65(0x193)), { isvalid } = require(_0x1e6a65(0x1ab)), mysql = require('mysql'), Importer = require(_0x1e6a65(0x199)), randomstring = require(_0x1e6a65(0x1d4)), { issession } = require(_0x1e6a65(0x18c)), fetch = require('node-fetch'); var fs = require('fs'); function _0x3389(_0x5368f7, _0x49ed4a) { const _0x338982 = _0xcab4(); return _0x3389 = function (_0x2579c4, _0x431091) { _0x2579c4 = _0x2579c4 - 0x172; let _0x150582 = _0x338982[_0x2579c4]; return _0x150582; }, _0x3389(_0x5368f7, _0x49ed4a); } router['get'](_0x1e6a65(0x17c), (_0x2415ff, _0x31d981) => { const _0x48777b = _0x1e6a65; var _0x29fc05 = _0x48777b(0x1b0); con['query'](_0x29fc05, (_0x35aacd, _0x204080) => { const _0x140cdd = _0x48777b; if (_0x35aacd) { _0x31d981[_0x140cdd(0x1ca)]({ 'msg': _0x140cdd(0x181), 'err': _0x35aacd }), console[_0x140cdd(0x1a1)](_0x35aacd); return; } else _0x31d981['json']({ 'data': _0x204080[0x0] }); }); }), router[_0x1e6a65(0x189)]('/update', isvalid, (_0xc0e7b6, _0x33ee54) => { const _0x47b218 = _0x1e6a65; var _0x2c9983 = _0x47b218(0x1b6) + _0xc0e7b6[_0x47b218(0x197)][_0x47b218(0x183)] + _0x47b218(0x194) + _0xc0e7b6['body'][_0x47b218(0x1c1)] + _0x47b218(0x186) + _0xc0e7b6['body'][_0x47b218(0x184)] + _0x47b218(0x1ba) + _0xc0e7b6[_0x47b218(0x197)][_0x47b218(0x1a5)] + '\x27,\x20offline_msg\x20=\x20\x27' + _0xc0e7b6[_0x47b218(0x197)][_0x47b218(0x19c)] + _0x47b218(0x1c3) + _0xc0e7b6['body'][_0x47b218(0x17b)] + _0x47b218(0x1cc) + _0xc0e7b6[_0x47b218(0x197)]['exchange_rate'] + _0x47b218(0x1a7) + _0xc0e7b6[_0x47b218(0x197)]['paypal_client_id'] + _0x47b218(0x1b7) + _0xc0e7b6[_0x47b218(0x197)][_0x47b218(0x1cf)] + '\x27'; con['query'](_0x2c9983, (_0x287994, _0x2788c7) => { const _0x328f3b = _0x47b218; if (_0x287994) { _0x33ee54['json']({ 'msg': 'Db\x20query\x20error', 'err': _0x287994 }), console[_0x328f3b(0x1a1)](_0x287994); return; } else _0x33ee54['json']({ 'msg': _0x328f3b(0x1a8), 'success': !![] }); }); }), router[_0x1e6a65(0x189)](_0x1e6a65(0x178), isvalid, (_0x181c68, _0x3f4086) => { const _0x2b421b = _0x1e6a65; var _0x3d2861 = 'UPDATE\x20web\x20SET\x20smtp_host\x20=\x20\x27' + _0x181c68[_0x2b421b(0x197)][_0x2b421b(0x185)] + _0x2b421b(0x19b) + _0x181c68[_0x2b421b(0x197)][_0x2b421b(0x1d1)] + '\x27,\x20smtp_email\x20=\x20\x27' + _0x181c68['body'][_0x2b421b(0x1a3)] + _0x2b421b(0x18e) + _0x181c68['body'][_0x2b421b(0x1ac)] + '\x27\x20'; con[_0x2b421b(0x19f)](_0x3d2861, (_0x26f6f3, _0x6b0a90) => { const _0x154b6c = _0x2b421b; if (_0x26f6f3) { _0x3f4086[_0x154b6c(0x1ca)]({ 'msg': _0x154b6c(0x181), 'err': _0x26f6f3 }), console[_0x154b6c(0x1a1)](_0x26f6f3); return; } else _0x3f4086[_0x154b6c(0x1ca)]({ 'msg': 'Settings\x20has\x20been\x20updated', 'success': !![] }); }); }), router[_0x1e6a65(0x189)](_0x1e6a65(0x18a), isvalid, (_0x5ce6e1, _0x1c55f6) => { const _0x5bfbfd = _0x1e6a65; if (_0x5ce6e1[_0x5bfbfd(0x195)]) { if (_0x5ce6e1[_0x5bfbfd(0x195)][_0x5bfbfd(0x188)] !== undefined) { const _0x1d5249 = _0x5ce6e1['files'][_0x5bfbfd(0x188)], _0x5b43d5 = ('' + Math[_0x5bfbfd(0x196)]())['substring'](0x2, 0x7) + Date[_0x5bfbfd(0x1ae)]() + _0x1d5249['name']; _0x1d5249['mv'](__dirname + _0x5bfbfd(0x19d) + _0x5b43d5, _0xd34dd6 => { const _0x4fd9fc = _0x5bfbfd; if (_0xd34dd6) return console[_0x4fd9fc(0x1a1)](_0xd34dd6), _0x1c55f6[_0x4fd9fc(0x1ca)]({ 'err': _0xd34dd6 }); }); var _0x143f49 = _0x5bfbfd(0x1b8) + _0x5ce6e1[_0x5bfbfd(0x197)][_0x5bfbfd(0x1ce)] + _0x5bfbfd(0x1d2) + _0x5ce6e1['body'][_0x5bfbfd(0x1c4)] + _0x5bfbfd(0x1c6) + _0x5ce6e1['body'][_0x5bfbfd(0x172)] + '\x27,\x20\x20logo\x20=\x20\x27' + _0x5b43d5 + _0x5bfbfd(0x1c9) + _0x5ce6e1[_0x5bfbfd(0x197)][_0x5bfbfd(0x1cb)] + '\x27\x20'; } } else var _0x143f49 = _0x5bfbfd(0x1b8) + _0x5ce6e1['body'][_0x5bfbfd(0x1ce)] + _0x5bfbfd(0x1d2) + _0x5ce6e1[_0x5bfbfd(0x197)][_0x5bfbfd(0x1c4)] + _0x5bfbfd(0x1c6) + _0x5ce6e1[_0x5bfbfd(0x197)][_0x5bfbfd(0x172)] + '\x27,\x20\x20home_video\x20=\x20\x27' + _0x5ce6e1['body'][_0x5bfbfd(0x1cb)] + '\x27\x20'; con['query'](_0x143f49, (_0x42098c, _0x53e396) => { const _0x5b215c = _0x5bfbfd; if (_0x42098c) { _0x1c55f6[_0x5b215c(0x1ca)]({ 'msg': 'Db\x20query\x20error', 'err': _0x42098c }), console[_0x5b215c(0x1a1)](_0x42098c); return; } else _0x1c55f6[_0x5b215c(0x1ca)]({ 'msg': _0x5b215c(0x1a8), 'success': !![] }); }); }), router[_0x1e6a65(0x1d8)](_0x1e6a65(0x1bc), (_0x4c1b43, _0x4cc76a) => { const _0x124f06 = _0x1e6a65; con[_0x124f06(0x19f)](_0x124f06(0x174), (_0x422ec1, _0x264e6b) => { _0x4cc76a['json'](_0x264e6b); }); }), router['get']('/check_install', issession, (_0x332c35, _0x331964) => { _0x331964['json']({ 'success': !![] }); }), router['post']('/install_app', async (_0x5f0c14, _0x1954a4) => { const _0x5daea9 = _0x1e6a65; console[_0x5daea9(0x1a1)](_0x5f0c14[_0x5daea9(0x197)]); const _0x3c7fb1 = _0x5f0c14[_0x5daea9(0x197)][_0x5daea9(0x1ce)], _0x5aea39 = _0x5f0c14[_0x5daea9(0x197)][_0x5daea9(0x172)], _0x11dd09 = _0x5f0c14[_0x5daea9(0x197)][_0x5daea9(0x1c8)], _0x5763ee = _0x5f0c14['body'][_0x5daea9(0x1d6)], _0x247b24 = _0x5f0c14[_0x5daea9(0x197)][_0x5daea9(0x18f)], _0x389a1f = _0x5f0c14[_0x5daea9(0x197)][_0x5daea9(0x176)], _0x5a8cd7 = _0x5f0c14['hostname']; if (!_0x3c7fb1 || !_0x5aea39 || !_0x11dd09 || !_0x5763ee || !_0x247b24 || !_0x389a1f || !_0x5a8cd7) return _0x1954a4[_0x5daea9(0x1ca)]({ 'msg': _0x5daea9(0x1b9) }); console[_0x5daea9(0x1a1)](_0x5a8cd7); let _0x4cfe42 = await fetch(_0x5daea9(0x1a2) + _0x389a1f + _0x5daea9(0x1c2) + _0x5a8cd7, { 'method': 'GET' }); if (_0x4cfe42[_0x5daea9(0x17e)] === 0xc8) { let _0x46f145 = await _0x4cfe42[_0x5daea9(0x1ca)](); if (!_0x46f145[_0x5daea9(0x18d)]) { console['log'](_0x46f145), _0x1954a4[_0x5daea9(0x1ca)]({ 'msg': _0x46f145[_0x5daea9(0x1a4)] }); return; } else { const _0x5c6b17 = mysql[_0x5daea9(0x187)]({ 'connectionLimit': 0x3e8, 'host': process['env'][_0x5daea9(0x1b4)], 'port': process['env'][_0x5daea9(0x1ad)], 'user': process[_0x5daea9(0x17d)]['DBUSER'], 'password': process[_0x5daea9(0x17d)][_0x5daea9(0x1be)], 'database': process[_0x5daea9(0x17d)][_0x5daea9(0x1af)] }); _0x5c6b17[_0x5daea9(0x175)](_0x47370a => { const _0x48595d = _0x5daea9; if (_0x47370a) { _0x1954a4[_0x48595d(0x1ca)]({ 'msg': 'It\x20seems\x20you\x20database\x20connection\x20credentials\x20are\x20invalid.', 'err': _0x47370a }), console[_0x48595d(0x1a1)](_0x47370a[_0x48595d(0x177)]); return; } else _0x5c6b17[_0x48595d(0x19f)](_0x48595d(0x17f) + process[_0x48595d(0x17d)][_0x48595d(0x1af)], async (_0x553d47, _0xc1c28d) => { const _0xc97a06 = _0x48595d; if (_0x553d47) { _0x1954a4[_0xc97a06(0x1ca)]({ 'msg': _0xc97a06(0x1a6), 'err': _0x553d47 }), console['log'](_0x553d47); return; } if (_0xc1c28d[_0xc97a06(0x1b5)] > 0x0) return _0x1954a4[_0xc97a06(0x1ca)]({ 'msg': 'It\x20seems\x20this\x20database\x20it\x20not\x20empty.\x20Please\x20choose\x20an\x20empty\x20mysql\x20database' }); else { const _0x3f872d = new Importer({ 'host': process[_0xc97a06(0x17d)][_0xc97a06(0x1b4)], 'user': process['env'][_0xc97a06(0x1af)], 'password': process[_0xc97a06(0x17d)][_0xc97a06(0x1be)], 'database': process['env'][_0xc97a06(0x1af)] }); _0x3f872d[_0xc97a06(0x1d3)](__dirname + '/../db/installer.sql')[_0xc97a06(0x1bb)](async () => { const _0x3ae082 = _0xc97a06, _0x515a16 = await bcrypt['hash'](_0x247b24, 0xa), _0x4706df = randomstring[_0x3ae082(0x1bf)]() + Date['now'](); _0x5c6b17[_0x3ae082(0x19f)]('INSERT\x20INTO\x20admin\x20(email,\x20password,\x20role,\x20uid)\x20VALUES\x20(\x27' + _0x5763ee + _0x3ae082(0x1a0) + _0x515a16 + '\x27,\x20\x27' + _0x3ae082(0x18b) + '\x27,\x27' + _0x4706df + '\x27)', (_0x420da0, _0x56cfee) => { const _0x392823 = _0x3ae082; if (_0x420da0) { console[_0x392823(0x1a1)](_0x420da0), _0x1954a4[_0x392823(0x1ca)]({ 'msg': _0x392823(0x1d0) }); return; } else _0x5c6b17[_0x392823(0x19f)](_0x392823(0x173) + _0x3c7fb1 + _0x392823(0x1a0) + _0x5aea39 + '\x27,\x27' + _0x11dd09 + _0x392823(0x190), (_0x2705da, _0x242fc8) => { const _0x229ae1 = _0x392823; if (_0x2705da) { console[_0x229ae1(0x1a1)](_0x2705da), _0x1954a4[_0x229ae1(0x1ca)]({ 'msg': 'DB\x20query\x20error' }); return; } else { const _0x34dba8 = __dirname + _0x229ae1(0x192); fs[_0x229ae1(0x1c0)](_0x34dba8, 'utf8', function (_0x2311e5, _0x45ab43) { const _0x3dd996 = _0x229ae1; if (_0x2311e5) return [console[_0x3dd996(0x1a1)](_0x2311e5), _0x1954a4[_0x3dd996(0x1ca)]({ 'success': ![], 'err': _0x2311e5 })]; var _0x5b3302 = _0x45ab43[_0x3dd996(0x1aa)](/no_installed_jwt/g, _0x46f145[_0x3dd996(0x191)]); fs[_0x3dd996(0x1bd)](_0x34dba8, _0x5b3302, _0x3dd996(0x1cd), function (_0x1cabca) { const _0x308799 = _0x3dd996; if (_0x1cabca) return [console[_0x308799(0x1a1)](_0x1cabca), _0x1954a4['json']({ 'msg': 'Files\x20permission\x20issue.' })]; fs[_0x308799(0x1c0)](_0x34dba8, 'utf8', function (_0x2db09e, _0x4948fc) { const _0x3610ec = _0x308799; if (_0x2db09e) return [console[_0x3610ec(0x1a1)](_0x2db09e), _0x1954a4[_0x3610ec(0x1ca)]({ 'success': ![], 'err': _0x2db09e })]; var _0x47ff8a = _0x4948fc[_0x3610ec(0x1aa)](/no_installed_token/g, _0x46f145[_0x3610ec(0x182)]); fs[_0x3610ec(0x1bd)](_0x34dba8, _0x47ff8a, _0x3610ec(0x1cd), function (_0x17258e) { const _0x4141b2 = _0x3610ec; if (_0x17258e) return [console[_0x4141b2(0x1a1)](_0x17258e), _0x1954a4[_0x4141b2(0x1ca)]({ 'msg': 'Files\x20permission\x20issue.' })]; }); }); }); }), _0x1954a4[_0x229ae1(0x1ca)]({ 'success': !![], 'msg': 'You\x20app\x20has\x20been\x20installed\x20Please\x20restart\x20your\x20Nodejs\x20App\x20Once!' }); } }); }); })[_0xc97a06(0x1b3)](_0x4826a3 => { const _0x429728 = _0xc97a06; console[_0x429728(0x1a9)](_0x4826a3), _0x1954a4[_0x429728(0x1ca)]({ 'err': _0x4826a3, 'msg': _0x429728(0x1d7) }); return; }); } }); }); } } else return _0x1954a4[_0x5daea9(0x1ca)]({ 'msg': _0x5daea9(0x1b1) }); }), module['exports'] = router;